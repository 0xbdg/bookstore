{% extends "base.html" %}

{% block midtrans %}<script type="text/javascript" src="https://app.sandbox.midtrans.com/snap/snap.js" data-client-key="{{ client_key }}"></script>{% endblock %}

{% block contents %}
<div class="container mt-5">
    <div class="d-flex align-items-center mb-3">
        <i class="fas fa-shopping-cart me-2"> </i>
        <h4 class="m-0">
            Your payment
        </h4>
    </div>
    <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center">
            <img alt="Black hoodie" class="me-2" height="50" src="https://via.placeholder.com/250x250/5fa9f8/ffffff" width="50" />
            <span class="me-2">
                {{ barang.produk}}
            </span>
        </div>
        <div>
            IDR {{ barang.harga}}
        </div>
    </div>
    <input type='hidden' id='snap_token' value="{{ token }}"/>
    <button id="checkout" class="btn btn-dark w-100 mt-3">
        Checkout
    </button>
</div>

<script>
    var token = document.querySelectorAll('#snap_token')[0].value;
    
    var checkoutBtn = document.querySelectorAll('#checkout')[0];
    checkoutBtn.onclick = function(){
            // Open Snap popup with defined callbacks.
        snap.pay(token, {
            onSuccess: function(result) {
                alert("Payment accepted");
            },
            onPending: function(result) {
                alert("Payment pending");
            },
            onError: function() {
                console.log("Payment error");
            }
        });
            // For more advanced use, refer to: https://snap-docs.midtrans.com/#snap-js
    }
</script>
{% endblock %}